# è§’è‰²ç»“æ„å¯¹æ¯”åˆ†æ

## ğŸ“Š è¯Šæ–­æŠ¥å‘Šå¯¹æ¯”

### ç©å®¶è§’è‰²ï¼ˆæ¸¸æˆæ­£å¸¸åˆ›å»ºï¼‰
```
Character(Clone)
â”œâ”€ ç»„ä»¶ (23 ä¸ª)
â”‚  â”œâ”€ CharacterMainControl
â”‚  â”œâ”€ Movement, Health, Rigidbody
â”‚  â”œâ”€ CharacterItemControl
â”‚  â””â”€ ... (æ­£å¸¸çš„æ¸¸æˆç»„ä»¶)
â”‚
â””â”€ å­å¯¹è±¡æ ‘
   â”œâ”€ ModelRoot/
   â”‚  â””â”€ 0_CharacterModel_Custom_Template(Clone)
   â”‚     â”œâ”€ CharacterModel âœ…
   â”‚     â”œâ”€ CharacterAnimationControl_MagicBlend âœ…
   â”‚     â””â”€ CustomFaceInstance/
   â”‚        â””â”€ Animator â­ (åœ¨è¿™é‡Œ)
   â”‚
   â”œâ”€ DamageReceiver/
   â”œâ”€ HiderPoints/
   â””â”€ Character(Clone)/ (ç‰©å“æ )
```

### æµ‹è¯•å•ä½ï¼ˆUnitManager åˆ›å»ºï¼‰
```
Custom
â”œâ”€ ç»„ä»¶ (25 ä¸ª)
â”‚  â”œâ”€ CharacterMainControl
â”‚  â”œâ”€ Movement, Health, Rigidbody
â”‚  â”œâ”€ CharacterItemControl
â”‚  â”œâ”€ ... (æ­£å¸¸çš„æ¸¸æˆç»„ä»¶)
â”‚  â””â”€ AI ç»„ä»¶ (Seeker, AI_PathControl, AICharacterController) â† é¢å¤–çš„
â”‚
â””â”€ å­å¯¹è±¡æ ‘
   â”œâ”€ ModelRoot/
   â”‚  â””â”€ 0_CharacterModel_Custom_Template(Clone)
   â”‚     â”œâ”€ CharacterModel âœ…
   â”‚     â”œâ”€ CharacterAnimationControl_MagicBlend âœ…
   â”‚     â””â”€ CustomFaceInstance/
   â”‚        â””â”€ Animator â­ (åœ¨è¿™é‡Œï¼Œä½ç½®ç›¸åŒï¼)
   â”‚
   â”œâ”€ DamageReceiver/
   â”œâ”€ HiderPoints/
   â””â”€ Character(Clone)/ (ç‰©å“æ )
```

## âœ… ç»“è®ºï¼šç»“æ„å®Œå…¨ä¸€è‡´ï¼

### ç›¸åŒç‚¹
1. **æ ¹å¯¹è±¡ç»„ä»¶**ï¼šæ‰€æœ‰æ ¸å¿ƒç»„ä»¶éƒ½ä¸€æ ·
2. **å­å¯¹è±¡å±‚çº§**ï¼šModelRoot â†’ CharacterModel â†’ CustomFaceInstance â†’ Animator
3. **Animator ä½ç½®**ï¼šéƒ½åœ¨å­™å­å¯¹è±¡ `CustomFaceInstance` ä¸Š
4. **åŠ¨ç”»æ§åˆ¶å™¨**ï¼šéƒ½æœ‰ `CharacterAnimationControl_MagicBlend`
5. **Animator é…ç½®**ï¼š
   - Controller: `CustomCharacterAnimationController_MagicBlend`
   - Layers: 3
   - Parameters: 10

### ä¸åŒç‚¹ï¼ˆåˆç†å·®å¼‚ï¼‰
1. **AI ç»„ä»¶**ï¼šæµ‹è¯•å•ä½å¤šäº† 3 ä¸ª AI ç»„ä»¶ï¼ˆè¿™æ˜¯æˆ‘ä»¬æ•…æ„æ·»åŠ çš„ï¼Œç”¨äºæ•Œäººè¡Œä¸ºï¼‰
2. **ç‰©å“æ å†…å®¹**ï¼šç©å®¶æœ‰æ›´å¤šè£…å¤‡ï¼ˆæ­£å¸¸ï¼Œæµ‹è¯•å•ä½æ˜¯æ–°å»ºçš„ï¼‰

## ğŸ”§ ä¸ºä»€ä¹ˆä¹‹å‰æ‰¾ä¸åˆ° Animatorï¼Ÿ

**åŸå› ï¼š** ä»£ç åªåœ¨æ ¹å¯¹è±¡ä¸ŠæŸ¥æ‰¾ `CharacterAnimationControl`

```csharp
// ä¹‹å‰çš„ä»£ç ï¼ˆæœ‰é—®é¢˜ï¼‰
var animControl = character.GetComponent(_characterAnimationControlType);
// âŒ åªåœ¨æ ¹å¯¹è±¡ä¸Šæ‰¾ï¼Œä½†å®ƒåœ¨å­å¯¹è±¡ä¸Šï¼
```

**ä¿®å¤ï¼š** åœ¨æ‰€æœ‰å­å¯¹è±¡ä¸­é€’å½’æŸ¥æ‰¾

```csharp
// ä¿®å¤åçš„ä»£ç 
var animControl = character.GetComponentInChildren(_characterAnimationControlType, true);
// âœ… åœ¨æ‰€æœ‰å­å¯¹è±¡ä¸­æŸ¥æ‰¾ï¼ˆåŒ…æ‹¬éæ¿€æ´»çš„ï¼‰
```

## ğŸ¯ UnitManager åˆ›å»ºæµç¨‹åˆ†æ

### æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯æ¸¸æˆå®˜æ–¹ API

```csharp
// 1. è·å–å®˜æ–¹çš„ CharacterCreator
var characterCreator = LevelManager.Instance.CharacterCreator;

// 2. ä½¿ç”¨å®˜æ–¹æ–¹æ³•åˆ›å»ºè§’è‰²
var newCharacter = await characterCreator.CreateCharacter(
    characterItem,    // è§’è‰²æ•°æ®
    modelPrefab,      // æ¨¡å‹é¢„åˆ¶ä½“
    position,         // ä½ç½®
    Quaternion.identity
);
```

### CharacterCreator.CreateCharacter åšäº†ä»€ä¹ˆï¼Ÿ

æ ¹æ®ç»“æ„å¯¹æ¯”ï¼Œè¿™ä¸ªå®˜æ–¹æ–¹æ³•å·²ç»å®Œæ•´åˆ›å»ºäº†ï¼š

1. âœ… è§’è‰² GameObject åŠæ‰€æœ‰ç»„ä»¶
2. âœ… ModelRoot å±‚çº§ç»“æ„
3. âœ… CharacterModel å®ä¾‹
4. âœ… CharacterAnimationControl ç»„ä»¶
5. âœ… CustomFaceInstance åŠ Animator
6. âœ… ç‰©ç†ç¢°æ’å™¨ã€å—ä¼¤æ£€æµ‹ç­‰

**ç»“è®ºï¼šæˆ‘ä»¬çš„åˆ›å»ºæµç¨‹æ˜¯æ­£ç¡®çš„ï¼ä½¿ç”¨çš„æ˜¯æ¸¸æˆåŸç”Ÿ APIã€‚**

## ğŸ“ é—®é¢˜æ€»ç»“

| é—®é¢˜ | åŸå›  | çŠ¶æ€ |
|------|------|------|
| æ‰¾ä¸åˆ° Animator | ä»£ç åªåœ¨æ ¹å¯¹è±¡æŸ¥æ‰¾ï¼Œæœªé€’å½’æœç´¢å­å¯¹è±¡ | âœ… å·²ä¿®å¤ |
| ç»“æ„ä¸ä¸€è‡´ï¼Ÿ | **è¯¯åˆ¤**ï¼Œç»“æ„å®Œå…¨ä¸€è‡´ | âœ… æ— é—®é¢˜ |
| åˆ›å»ºæµç¨‹æœ‰é—®é¢˜ï¼Ÿ | **è¯¯åˆ¤**ï¼Œä½¿ç”¨å®˜æ–¹ APIï¼Œæµç¨‹æ­£ç¡® | âœ… æ— é—®é¢˜ |

## ğŸš€ ç°åœ¨çš„çŠ¶æ€

- âœ… ç»“æ„ï¼šå®Œå…¨ä¸€è‡´
- âœ… åˆ›å»ºæµç¨‹ï¼šä½¿ç”¨å®˜æ–¹ API
- âœ… Animator æŸ¥æ‰¾ï¼šå·²ä¿®å¤ï¼ˆé€’å½’æœç´¢ï¼‰
- âœ… åŠ¨ç”»ç³»ç»Ÿï¼šåº”è¯¥å¯ä»¥æ­£å¸¸å·¥ä½œ

## ğŸ’¡ å»ºè®®

å¦‚æœåŠ¨ç”»è¿˜æ˜¯ä¸å·¥ä½œï¼Œå¯èƒ½çš„é—®é¢˜ï¼š
1. Animator çš„ Controller æœªæ¿€æ´»
2. åŠ¨ç”»å‚æ•°åç§°ä¸åŒ¹é…
3. è§’è‰²çŠ¶æ€æœºæœªæ­£ç¡®åˆå§‹åŒ–

å¯ä»¥ä½¿ç”¨ F5 åŠ¨ç”»è°ƒè¯•çª—å£è¿›ä¸€æ­¥è¯Šæ–­ã€‚

