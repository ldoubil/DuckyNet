<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DuckyNet æœåŠ¡å™¨ç®¡ç†åå°</title>
    <link rel="stylesheet" href="/css/steam-style.css">
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
</head>
<body>
    <div id="app">
        <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
        <header class="steam-header">
            <div class="header-logo">
                <h1>ğŸ¦† DuckyNet æœåŠ¡å™¨ç®¡ç†</h1>
            </div>
            <div class="header-nav">
                <button 
                    v-for="tab in tabs" 
                    :key="tab.id"
                    @click="currentTab = tab.id"
                    :class="['nav-button', { active: currentTab === tab.id }]">
                    {{ tab.name }}
                </button>
            </div>
            <div class="header-time">
                <span>{{ serverTime }}</span>
            </div>
        </header>

        <!-- ä¸»è¦å†…å®¹åŒº -->
        <main class="steam-main">
            <!-- æ€»è§ˆé¢æ¿ -->
            <div v-if="currentTab === 'overview'" class="content-panel">
                <h2 class="panel-title">æœåŠ¡å™¨æ¦‚è§ˆ</h2>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">ğŸ‘¥</div>
                        <div class="stat-content">
                            <div class="stat-value">{{ overview.onlinePlayers }}</div>
                            <div class="stat-label">åœ¨çº¿ç©å®¶</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">ğŸ </div>
                        <div class="stat-content">
                            <div class="stat-value">{{ overview.totalRooms }}</div>
                            <div class="stat-label">æ´»è·ƒæˆ¿é—´</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">ğŸ¤–</div>
                        <div class="stat-content">
                            <div class="stat-value">{{ overview.totalNpcs }}</div>
                            <div class="stat-label">NPCæ•°é‡</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">â±ï¸</div>
                        <div class="stat-content">
                            <div class="stat-value">{{ overview.uptime }}</div>
                            <div class="stat-label">è¿è¡ŒçŠ¶æ€</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- æˆ¿é—´åˆ—è¡¨ -->
            <div v-if="currentTab === 'rooms'" class="content-panel">
                <h2 class="panel-title">æˆ¿é—´åˆ—è¡¨</h2>
                <div class="room-list">
                    <div v-for="room in rooms" :key="room.roomId" class="room-card" @click="selectRoom(room)">
                        <div class="room-header">
                            <span class="room-name">{{ room.roomName }}</span>
                            <span class="room-id">{{ room.roomId }}</span>
                        </div>
                        <div class="room-info">
                            <span>æˆ¿ä¸»: {{ room.hostSteamId }}</span>
                            <span class="room-players">ğŸ‘¥ {{ room.currentPlayers }}/{{ room.maxPlayers }}</span>
                        </div>
                        <div class="room-meta">
                            <span v-if="room.requirePassword" class="badge">ğŸ”’ éœ€è¦å¯†ç </span>
                            <span v-if="room.isFull" class="badge full">å·²æ»¡</span>
                            <span class="room-time">åˆ›å»º: {{ formatTime(room.createTime) }}</span>
                        </div>
                    </div>
                    <div v-if="rooms.length === 0" class="empty-state">
                        æš‚æ— æ´»è·ƒæˆ¿é—´
                    </div>
                </div>

                <!-- æˆ¿é—´è¯¦æƒ…é¢æ¿ -->
                <div v-if="selectedRoom" class="detail-panel">
                    <h3>æˆ¿é—´è¯¦æƒ… - {{ selectedRoom.roomName }}</h3>
                    <button @click="selectedRoom = null" class="close-btn">âœ–</button>
                    <div class="detail-content">
                        <p><strong>æˆ¿é—´ID:</strong> {{ selectedRoom.roomId }}</p>
                        <p><strong>æè¿°:</strong> {{ selectedRoom.description || 'æ— ' }}</p>
                        <p><strong>æˆ¿ä¸»:</strong> {{ selectedRoom.hostSteamId }}</p>
                        <h4>æˆ¿é—´å†…ç©å®¶:</h4>
                        <div v-if="roomPlayers.length > 0" class="player-mini-list">
                            <div v-for="player in roomPlayers" :key="player.steamId" class="player-mini-card">
                                <span class="player-name">{{ player.steamName }}</span>
                                <span class="player-scene">{{ player.sceneName || 'æœªè¿›å…¥åœºæ™¯' }}</span>
                            </div>
                        </div>
                        <div v-else class="empty-state">æš‚æ— ç©å®¶</div>
                    </div>
                </div>
            </div>

            <!-- ç©å®¶åˆ—è¡¨ -->
            <div v-if="currentTab === 'players'" class="content-panel">
                <h2 class="panel-title">åœ¨çº¿ç©å®¶åˆ—è¡¨</h2>
                <div class="player-list">
                    <div v-for="player in players" :key="player.steamId" class="player-card">
                        <div class="player-avatar">ğŸ‘¤</div>
                        <div class="player-info">
                            <div class="player-name">{{ player.steamName }}</div>
                            <div class="player-id">{{ player.steamId }}</div>
                        </div>
                        <div class="player-status">
                            <div v-if="player.roomName" class="player-room">
                                ğŸ  {{ player.roomName }}
                            </div>
                            <div v-if="player.sceneName" class="player-scene">
                                ğŸ—ºï¸ {{ player.sceneName }}{{ player.subSceneName ? '/' + player.subSceneName : '' }}
                            </div>
                            <div v-if="player.position" class="player-position">
                                ğŸ“ ({{ player.position.x.toFixed(1) }}, {{ player.position.y.toFixed(1) }}, {{ player.position.z.toFixed(1) }})
                            </div>
                        </div>
                    </div>
                    <div v-if="players.length === 0" class="empty-state">
                        æš‚æ— åœ¨çº¿ç©å®¶
                    </div>
                </div>
            </div>

            <!-- åœºæ™¯åˆ—è¡¨ -->
            <div v-if="currentTab === 'scenes'" class="content-panel">
                <h2 class="panel-title">åœºæ™¯åˆ—è¡¨</h2>
                <div class="scene-list">
                    <div v-for="scene in scenes" :key="scene.sceneName + scene.subSceneName" 
                         class="scene-card" @click="selectScene(scene)">
                        <div class="scene-header">
                            <span class="scene-name">{{ scene.sceneName }}</span>
                            <span v-if="scene.subSceneName" class="scene-sub">/ {{ scene.subSceneName }}</span>
                        </div>
                        <div class="scene-stats">
                            <span>ğŸ‘¥ {{ scene.playerCount }} ç©å®¶</span>
                            <span>ğŸ¤– {{ scene.npcCount }} NPC</span>
                        </div>
                    </div>
                    <div v-if="scenes.length === 0" class="empty-state">
                        æš‚æ— æ´»è·ƒåœºæ™¯
                    </div>
                </div>

                <!-- åœºæ™¯è¯¦æƒ…é¢æ¿ -->
                <div v-if="selectedScene" class="detail-panel">
                    <h3>åœºæ™¯è¯¦æƒ… - {{ selectedScene.sceneName }}/{{ selectedScene.subSceneName }}</h3>
                    <button @click="selectedScene = null; sceneDetail = null" class="close-btn">âœ–</button>
                    <div class="detail-content" v-if="sceneDetail">
                        <h4>åœºæ™¯å†…ç©å®¶:</h4>
                        <div v-if="sceneDetail.players.length > 0" class="entity-list">
                            <div v-for="player in sceneDetail.players" :key="player.steamId" class="entity-card">
                                <span class="entity-name">ğŸ‘¤ {{ player.steamName }}</span>
                                <span v-if="player.position" class="entity-pos">
                                    ğŸ“ ({{ player.position.x.toFixed(1) }}, {{ player.position.y.toFixed(1) }}, {{ player.position.z.toFixed(1) }})
                                </span>
                            </div>
                        </div>
                        
                        <h4>åœºæ™¯å†…NPC:</h4>
                        <div v-if="sceneDetail.npcs.length > 0" class="entity-list">
                            <div v-for="npc in sceneDetail.npcs" :key="npc.npcId" class="entity-card npc">
                                <div class="npc-main">
                                    <span class="entity-name">ğŸ¤– {{ npc.npcType }}</span>
                                    <span class="npc-id">{{ npc.npcId }}</span>
                                </div>
                                <div class="npc-stats">
                                    <span class="npc-health">â¤ï¸ {{ npc.maxHealth }}</span>
                                    <span class="entity-pos">
                                        ğŸ“ ({{ npc.position.x.toFixed(1) }}, {{ npc.position.y.toFixed(1) }}, {{ npc.position.z.toFixed(1) }})
                                    </span>
                                </div>
                                <div class="npc-meta">
                                    <span class="npc-owner">æ‹¥æœ‰è€…: {{ npc.owner }}</span>
                                </div>
                            </div>
                        </div>
                        <div v-else class="empty-state">æš‚æ— NPC</div>
                    </div>
                </div>
            </div>
        </main>

        <!-- åŠ è½½æç¤º -->
        <div v-if="loading" class="loading-overlay">
            <div class="loading-spinner">åŠ è½½ä¸­...</div>
        </div>
    </div>

    <script src="/js/app.js"></script>
</body>
</html>

